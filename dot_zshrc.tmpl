#!/bin/zsh

DISABLE_AUTO_UPDATE="true"

if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
	source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

export ZSH=~/.oh-my-zsh

if [[ "$TERM" != "dumb" ]]; then
	ZSH_THEME="powerlevel10k"
	[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
fi

CASE_SENSITIVE="true"

plugins=(git git-flow-avh golang httpie)


{{ if eq .org "softiron" }}	# SoftIron
export SOFTIRON=1
{{ end }}


ls=ls

{{ if eq .chezmoi.os "darwin" }} # MacOS
plugins+=(brew colorize docker docker-compose thefuck)

ls=gls

if [[ -z "$INSIDE_EMACS" ]]; then
	test -e "${HOME}/.iterm2_shell_integration.zsh" && source "${HOME}/.iterm2_shell_integration.zsh"
fi

alias ack="ag"
alias fack="ag -Q"

export BAT_THEME=ansi

if [[ -f /usr/local/bin/src-hilite-lesspipe.sh ]]; then
	export LESSOPEN="| /usr/local/bin/src-hilite-lesspipe.sh %s"
	export LESS=" -R "
fi

{{ end }}


eval `dircolors -b "${HOME}/.dircolors"`

DEFAULT_USER=`whoami`

source $ZSH/oh-my-zsh.sh

COMPLETIONS=~/.completions
[[ -d $COMPLETIONS ]] || mkdir $COMPLETIONS
fpath=($COMPLETIONS $fpath)

autoload -Uz compinit; compinit


# Do this after zsh setup to fix the ls aliases

case $TERM in
eterm-*color)
	chpwd() { print -P "\033AnSiTc %d" }
	print -P "\033AnSiTu %n"
	print -P "\033AnSiTc %d"
	ls="$ls -F --color"
	DISABLE_AUTO_TITLE="true"
	;;
xterm*|screen*color)
	ls="$ls -F --color"
        ;;
esac

unalias ls
unalias lsa

alias ls=$ls
alias la="$ls -a"
alias ll="$ls -l"

alias m='make'

export VISUAL=emacsclient
export EDITOR=emacsclient
export ALTERNATE_EDITOR='emacs -nw'
alias e='emacsclient'

setopt inc_append_history
unsetopt sharehistory

